name: Test Check RETCODE Action

on:
  workflow_dispatch:
  push:
    branches:
      - "feature/check-retcode"

jobs:
  test-retcodes:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Debug codes.json
        run: |
          echo "Contenido real de codes.json leído por el runner:"
          cat ./.github/actions/check-retcode/codes.json

      - name: success status
        uses: ./.github/actions/check-retcode
        with:
          retcode: 2
          config_file: './.github/actions/check-retcode/codes.json'
        continue-on-error: true

      - name: código de retorno inesperado
        uses: ./.github/actions/check-retcode
        with:
          retcode: "s40"
          config_file: './.github/actions/check-retcode/codes.json'
        continue-on-error: true

      - name: código de retorno inesperado 2
        uses: ./.github/actions/check-retcode
        with:
          retcode: "40"
          config_file: './.github/actions/check-retcode/codes.json'
        continue-on-error: true

      - name: No se encontró archivo
        uses: ./.github/actions/check-retcode
        with:
          retcode: "0"
          config_file: './.github/actions/check-retcode/test/codes.json'
        continue-on-error: true

      - name: JSON no tiene estructura
        uses: ./.github/actions/check-retcode
        with:
          retcode: "0"
          config_file: './.github/actions/check-retcode/prueba/codes.json'
        continue-on-error: true